using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using WebAppPenTest.Common.Models;

namespace WebAppPenTest.Domain {
    public static class Logger {
        private static string LOG_DIR = Path.GetTempPath();    //TODO: make this an option
        private static string LOG_NAME = "PenTest.log";
        private static string LOG_PATH = string.Concat(LOG_DIR, LOG_NAME);
        private static LogVerbosity VerbosityLevel = LogVerbosity.Minimum;  //TODO: make this an option

        public static async Task<string> ReadAsync() {
            var log = string.Empty;

            using (var sr = new StreamReader(LOG_PATH)) {
                log = await sr.ReadToEndAsync();

                return log;
            }
        }
        public static string Read() {
            var log = string.Empty;

            using (var sr = new StreamReader(LOG_PATH)) {
                log = sr.ReadToEnd();

                return log;    
            }
        }
        public static async Task WriteAsync(string message) {
            await WriteAsync(message, VerbosityLevel);
        }
        public static async Task WriteAsync(string message, LogVerbosity verbosity) {
            using (var sw = new StreamWriter(LOG_DIR)) {
                await sw.WriteLineAsync(message);
            }
        }
        public static void Write(string message) {
            Write(message, VerbosityLevel);
        }
        public static void Write(string message, LogVerbosity verbosity) {
            using (var sw = new StreamWriter(LOG_DIR)) {
                sw.WriteLine(message);
            }
        }
    }
}
