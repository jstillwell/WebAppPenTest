using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using WebAppPenTest.Proxy;
using WebAppPenTest.Spider;

namespace TestConsoleApplication {
    class Program {
        static void Main(string[] args) {
            try {
                string url;
                if (args != null && args.Length > 0) {
                    url = args[0];
                } else {
                    throw new ArgumentException("Please provide a URL to start from.");
                }

                using (var Listener = new Listener()) {
                    Task.Factory.StartNew(() => {
                        Listener.StartListener();
                    });
                    
                    //var starttime = DateTime.UtcNow;
                    //var crawler = new Crawler(url);
                    //var results = crawler.Crawl();
                    //var endtime = DateTime.UtcNow;
                    //var time = starttime - endtime;

                    //Console.WriteLine(string.Format("There are {0} in the Queue", results.Count));
                    //Console.WriteLine(string.Format("That took {0}ms", time.TotalMilliseconds));
                    //Console.WriteLine(string.Format("or {0}seconds", time.TotalSeconds));

                    Console.ReadKey();
                };
            } catch (Exception x) {
                Console.WriteLine("Exception: {0}", x.Message);
            }
        }
    }
}
